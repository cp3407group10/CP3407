<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySync - Courses</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/course.css') }}">
</head>
<body>
<header>
    <nav>
        <ul class="nav-links">
            <li><a href="/login">Login</a></li>
            <li><a href="/register">Sign up</a></li>
            <li><a href="/">Home</a></li>
            <li><a href="/course">Courses</a></li>
            <li><a href="/contact">Contact</a></li>
        </ul>
        <div class="search-bar">
            <input type="text" placeholder="Search">
        </div>
        <div class="logo">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="StudySync Logo" style="width: 80px; height: auto;">
        </div>
    </nav>
</header>

<main>

        <section class="created-courses">
        <h2>Courses I Joined</h2>
        <div class="courses-container" id="created-courses">
            <!-- Dynamically added courses will appear here -->
        </div>
    </section>
    <section class="courses-section">
        <h2>Available Courses</h2>
        <div class="courses-container" id="available-courses">
            {% for course in courses %}
            <div class="course" data-course-id="{{ course.course_id }}">
                <h3>{{ course.course_name }}</h3>
                <p>{{ course.course_content }}</p>
                <button onclick="joinSession(this)">Join Session</button>
            </div>
            {% endfor %}
        </div>
    </section>


</main>

<script>
function joinSession(button) {
    const course = button.closest('.course');
    document.getElementById('created-courses').appendChild(course);
    button.textContent = 'Leave Session';
    button.onclick = function() { leaveSession(this); };

    // Optionally, make an AJAX call to the server to persist the change
    const courseId = course.getAttribute('data-course-id');
    fetch('/join_course', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ course_id: courseId }),
    });
}

function leaveSession(button) {
    const course = button.closest('.course');
    document.getElementById('available-courses').appendChild(course);
    button.textContent = 'Join Session';
    button.onclick = function() { joinSession(this); };

    // Optionally, make an AJAX call to the server to persist the change
    const courseId = course.getAttribute('data-course-id');
    fetch('/leave_course', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ course_id: courseId }),
    });
}
</script>

</body>
</html>
